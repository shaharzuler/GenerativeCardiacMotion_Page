<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description"
          content="Synthetic Flow Field Generation for Myocardium Deformation Analysis">
    <meta name="keywords"
          content="Synthetic data generation, myocardium deformation, 3D optical flow, conditional VAE, Deep neural networks">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Synthetic Flow Field Generation for Myocardium Deformation Analysis</title>


    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-ZCP2YS41P0"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-ZCP2YS41P0');
    </script>

    <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
          rel="stylesheet">

    <link rel="stylesheet" href="./static/css/bulma.min.css">
    <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
    <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
    <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
    <link rel="stylesheet" href="./static/css/index.css">
    <link rel="icon" href="./static/images/favicon.png">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script defer src="./static/js/fontawesome.all.min.js"></script>
    <script src="./static/js/bulma-carousel.min.js"></script>
    <script src="./static/js/bulma-slider.min.js"></script>
    <script src="./static/js/index.js"></script>
</head>
<body>

<section class="hero">
    <div class="hero-body">
        <div class="container is-max-desktop">
            <div class="columns is-centered">
                <div class="column has-text-centered">
                    <h1 class="title is-1 publication-title">Synthetic Flow Field Generation for Myocardium Deformation
                        Analysis.</h1>
                    <div class="is-size-5 publication-authors">
                        <div class="author-block">
                            <p><a>Shahar Zuler</a></p>
                        </div>
                        <br>
                        <div class="author-block">
                            <p>Supervised by:</p>
                        </div>
                        <div class="author-block">
                            <p><a>Gal Lifshitz</a> and <a>Dan Raviv</a></p>
                        </div>


                    </div>
                    <div class="column has-text-centered">
                        <div class="publication-links">
                            <!-- PDF Link. -->
                            <span class="link-block">
            <a href="static/pdf/report.pdf"
               class="external-link button is-normal is-rounded is-dark">
                <span class="icon">
                    <i class="fas fa-file-pdf"></i>
                </span>
                <span>Report</span>
            </a>
        </span>
                            <!-- Code Link. -->
                            <span class="link-block">
            <a href="https://github.com/shaharzuler/CVAE"
               class="external-link button is-normal is-rounded is-dark">
                <span class="icon">
                    <i class="fab fa-github"></i>
                </span>
                <span>Code</span>
            </a>
        </span>
                        </div>
                    </div>
                </div>


            </div>
        </div>
    </div>
    </div>
</section>

<section class="hero teaser">
    <div class="container is-max-desktop">
        <div class="hero-body">
            <img id="teaser" src="./static/images/generated42.gif" alt="Generated Sequence of Myocardium Deformation"
                 style="width: 100%; height: auto;">
            <h2 class="subtitle has-text-centered">
                This animation demonstrates a smooth transition generated by the Conditional Variational Autoencoder
                (CVAE), showing the heartâ€™s deformation from systole to diastole.
                The frames are interpolated between two key states to visualize the motion.
            </h2>
        </div>
    </div>
</section>

<section class="section">
    <div class="container is-max-desktop">
        <!-- Abstract. -->
        <div class="columns is-centered has-text-centered">
            <div class="column is-four-fifths">
                <h2 class="title is-3">Abstract</h2>
                <div class="content has-text-justified">
                    <p>
                        This project presents a method for generating synthetic 3D flow fields to warp real cardiac
                        Computed
                        Tomography (CT) frames, creating pairs of images with synthetic deformations that serve as
                        ground
                        truth annotations. A conditional Variational Autoencoder (CVAE) is employed to generate flow
                        fields
                        conditioned on a single CT frame, enabling the synthesis of realistic deformations for training
                        and
                        validating deep learning models in myocardium motion analysis.
                        <br>
                        The proposed method significantly reduces the dependency on manual annotations, which are
                        practically infeasible for dense voxel-level deformation tasks.
                        By providing synthetic annotations, this project lays the groundwork for the development of more
                        complex myocardium motion models.
                    </p>
                </div>
            </div>
        </div>
        <!--/ Abstract. -->
    </div>
</section>

<section class="section hero is-light">
    <div class="container is-max-desktop">
        <div class="columns is-centered has-text-centered">
            <div class="column is-four-fifths">
                <h2 class="title is-3">How Does It Work?</h2>
                <div class="content has-text-justified">
                    <p>
                        The CVAE pipeline generates 3D flow fields conditioned on real cardiac CT frames.
                        These flow fields warp systole frames into diastole frames, forming realistic annotated pairs of
                        deformed heart images.
                    </p>
                    <img src="static/images/generation_pipeline.png" alt="Generation Pipeline">
                    <p>
                        <br>Estimated flow based on known methods serve as ground truth annotations for the CVAE.
                    </p>
                    <img src="static/images/training_pipeline.png" alt="Training Pipeline">
                </div>
            </div>
        </div>
    </div>
</section>


<section class="section">
    <div class="has-text-centered">
        <h2 class="title is-3">Comparison of Generated Heart Animations and Ground Truth Data</h2>
        <h3 class="subtitle is-6">(This section is best viewed from a desktop)</h3>
    </div>
    <div class="container is-max-desktop">
        <p>
            <br>The following table showcases examples of the generated heart animations alongside their
            corresponding ground truth data.
            For each row, you will see a generated animation (systole to diastole transformation), the CVAE ground truth
            (GT), the original CT scan, and visualizations of both the predicted and ground truth flow fields.
            This allows for a clear comparison between the model's predictions and the actual deformations captured in
            the original data.
        </p>
        <br>
        <!-- Titles Row -->
        <div class="columns is-centered has-text-centered">
            <div class="column is-one-third">
                <h3 class="title is-8" style="font-size: 1.5rem;">Generated Animation</h3>
            </div>
            <div class="column is-one-third">
                <h3 class="title is-8" style="font-size: 1.5rem;">CVAE GT</h3>
            </div>
            <div class="column is-one-third">
                <h3 class="title is-8" style="font-size: 1.5rem;">Original Scan</h3>
            </div>
            <div class="column is-one-fifth">
                <h3 class="title is-8" style="font-size: 1.5rem;">Generated Flow</h3>
            </div>
            <div class="column is-one-fifth">
                <h3 class="title is-8" style="font-size: 1.5rem;">GT Flow</h3>
            </div>
        </div>
        <!-- /Titles Row -->

        <!-- Row 1 -->
        <div class="columns is-centered has-text-centered">
            <div class="column is-one-third">
                <figure class="image is-384x384">
                    <img src="static/images/generated4.gif" alt="Generated Animation #4">
                </figure>
            </div>
            <div class="column is-one-third">
                <figure class="image is-384x384">
                    <img src="static/images/generated4_gt.gif" alt="CVAE GT #4">
                </figure>
            </div>
            <div class="column is-one-third">
                <figure class="image is-384x384">
                    <img src="static/images/image_animation_mask_p5_match4.gif" alt="Original Scan #4">
                </figure>
            </div>
            <div class="column is-one-fifth">
                <figure class="image is-128x128">
                    <img src="static/images/4_f_gen.png" alt="Generated Flow #4">
                </figure>
            </div>
            <div class="column is-one-fifth">
                <figure class="image is-128x128">
                    <img src="static/images/4_f_gt.png" alt="GT Flow #4">
                </figure>
            </div>
        </div>
        <!-- /Row 1 -->

        <!-- Row 2 -->
        <div class="columns is-centered has-text-centered">
            <div class="column is-one-third">
                <figure class="image is-384x384">
                    <img src="static/images/generated9.gif" alt="Generated Animation #9">
                </figure>
            </div>
            <div class="column is-one-third">
                <figure class="image is-384x384">
                    <img src="static/images/generated9_gt.gif" alt="CVAE GT #9">
                </figure>
            </div>
            <div class="column is-one-third">
                <figure class="image is-384x384">
                    <img src="static/images/image_animation_mask_p11_match9.gif" alt="Original Scan #9">
                </figure>
            </div>
            <div class="column is-one-fifth">
                <figure class="image is-128x128">
                    <img src="static/images/9_f_gen.png" alt="Generated Flow #9">
                </figure>
            </div>
            <div class="column is-one-fifth">
                <figure class="image is-128x128">
                    <img src="static/images/9_f_gt.png" alt="GT Flow #9">
                </figure>
            </div>
        </div>
        <!-- /Row 2 -->

        <!-- Row 3 -->
        <div class="columns is-centered has-text-centered">
            <div class="column is-one-third">
                <figure class="image is-384x384">
                    <img src="static/images/generated31.gif" alt="Generated Animation #31">
                </figure>
            </div>
            <div class="column is-one-third">
                <figure class="image is-384x384">
                    <img src="static/images/generated31_gt.gif" alt="CVAE GT #31">
                </figure>
            </div>
            <div class="column is-one-third">
                <figure class="image is-384x384">
                    <img src="static/images/image_animation_mask_p42_match31.gif" alt="Original Scan #31">
                </figure>
            </div>
            <div class="column is-one-fifth">
                <figure class="image is-128x128">
                    <img src="static/images/31_f_gen.png" alt="Generated Flow #31">
                </figure>
            </div>
            <div class="column is-one-fifth">
                <figure class="image is-128x128">
                    <img src="static/images/31_f_gt.png" alt="GT Flow #31">
                </figure>
            </div>
        </div>
        <!-- /Row 3 -->

        <!-- Row 4 -->
        <div class="columns is-centered has-text-centered">
            <div class="column is-one-third">
                <figure class="image is-384x384">
                    <img src="static/images/generated39.gif" alt="Generated Animation #39">
                </figure>
            </div>
            <div class="column is-one-third">
                <figure class="image is-384x384">
                    <img src="static/images/generated39_gt.gif" alt="CVAE GT #39">
                </figure>
            </div>
            <div class="column is-one-third">
                <figure class="image is-384x384">
                    <img src="static/images/image_animation_mask_p_53_match39.gif" alt="Original Scan #39">
                </figure>
            </div>
            <div class="column is-one-fifth">
                <figure class="image is-128x128">
                    <img src="static/images/39_f_gen.png" alt="Generated Flow #39">
                </figure>
            </div>
            <div class="column is-one-fifth">
                <figure class="image is-128x128">
                    <img src="static/images/39_f_gt.png" alt="GT Flow #39">
                </figure>
            </div>
        </div>
        <!-- /Row 4 -->
    </div>
</section>


<section class="section hero is-light">
    <div class="container is-max-desktop">
        <div class="columns is-centered has-text-centered">
            <div class="column is-four-fifths">
                <h2 class="title is-3">CVAE Architecture</h2>
                <div class="content has-text-justified">
                    <p>
                        The architecture consists of several key components collaborating to produce these flow fields
                        from a single conditioned CT frame.
                    </p>
                    <ul>
                        <li>An encoder that reduces the flow field into a latent space representation.</li>
                        <li>A decoder that reconstructs the flow field from the latent space, conditioned on the input
                            CT frame.
                        </li>
                        <li>A feature pyramid network that extracts multi-scale features from the input CT frame.</li>
                    </ul>
                    <img src="static/images/archi_improved.png" alt="Training Pipeline">
                </div>
            </div>
        </div>
    </div>
</section>


<section class="section">
    <div class="container is-max-desktop">
        <div class="columns is-centered has-text-centered">
            <div class="column is-four-fifths">
                <h2 class="title is-3">Latent Space Exploration</h2>
                <div class="content has-text-justified">
                    <p>
                        The latent space was explored by conducting a grid search across different latent variables,
                        visualizing the corresponding generated flow fields.
                        The latent space appears continuous, with different deformations generated for the same
                        conditioned frame.
                        The deformed frames appear anatomically feasible.
                        This exploration is visualized below.
                    </p>
                    <div class="columns is-centered">
                        <div class="column is-four-fifths">
                            <figure class="image">
                                <img src="static/images/flow_dist_z_tight.png" alt="Flow Dist Z Axis">
                            </figure>
                        </div>
                        <div class="column is-four-fifths">
                            <figure class="image">
                                <img src="static/images/output_large_gif_3_axes.gif" alt="Output Large GIF 3 Axes">
                            </figure>
                        </div>
                    </div>

                    <div class="columns is-centered">
                        <div class="column is-four-fifths">
                            <figure class="image">
                                <img src="static/images/flow_dist_z_tight_arrow.png" alt="Flow Dist Z Axis">
                            </figure>
                        </div>
                        <div class="column is-four-fifths">
                            <figure class="image">
                                <video src="static/videos/change_in_flow.mp4" controls></video>
                            </figure>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<footer class="footer">
    <div class="columns is-centered">
        <div class="column is-8">
            <div class="content">
                <p>
                    Website source code based on the <a href="https://nerfies.github.io/"> Nerfies</a> project page. If
                    you want to reuse their <a
                        href="https://github.com/nerfies/nerfies.github.io">source code</a>, please credit them
                    appropriately.
                </p>
            </div>
        </div>
    </div>

</footer>

</body>
</html>